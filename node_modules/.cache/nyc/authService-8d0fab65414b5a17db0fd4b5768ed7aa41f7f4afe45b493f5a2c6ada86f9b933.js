function cov_8xupy7a1z(){var path="D:\\rippers\\rippers-bn-be\\src\\Services\\authService.js";var hash="25acb9f92b55eba742f56a9f40706d8493f2935d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"D:\\rippers\\rippers-bn-be\\src\\Services\\authService.js",statementMap:{"0":{start:{line:3,column:4},end:{line:3,column:34}},"1":{start:{line:6,column:4},end:{line:6,column:27}},"2":{start:{line:7,column:12},end:{line:7,column:35}},"3":{start:{line:8,column:15},end:{line:8,column:61}},"4":{start:{line:9,column:20},end:{line:51,column:1}},"5":{start:{line:10,column:2},end:{line:50,column:3}},"6":{start:{line:11,column:19},end:{line:14,column:6}},"7":{start:{line:15,column:20},end:{line:15,column:39}},"8":{start:{line:16,column:18},end:{line:16,column:31}},"9":{start:{line:17,column:17},end:{line:21,column:6}},"10":{start:{line:22,column:4},end:{line:26,column:5}},"11":{start:{line:23,column:20},end:{line:23,column:88}},"12":{start:{line:24,column:6},end:{line:24,column:29}},"13":{start:{line:25,column:6},end:{line:25,column:18}},"14":{start:{line:27,column:22},end:{line:32,column:6}},"15":{start:{line:33,column:4},end:{line:40,column:6}},"16":{start:{line:42,column:4},end:{line:44,column:5}},"17":{start:{line:43,column:6},end:{line:43,column:29}},"18":{start:{line:46,column:4},end:{line:48,column:5}},"19":{start:{line:47,column:6},end:{line:47,column:52}},"20":{start:{line:49,column:4},end:{line:49,column:16}},"21":{start:{line:52,column:0},end:{line:54,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:9,column:20},end:{line:9,column:21}},loc:{start:{line:9,column:35},end:{line:51,column:1}},line:9}},branchMap:{"0":{loc:{start:{line:22,column:4},end:{line:26,column:5}},type:"if",locations:[{start:{line:22,column:4},end:{line:26,column:5}},{start:{line:22,column:4},end:{line:26,column:5}}],line:22},"1":{loc:{start:{line:42,column:4},end:{line:44,column:5}},type:"if",locations:[{start:{line:42,column:4},end:{line:44,column:5}},{start:{line:42,column:4},end:{line:44,column:5}}],line:42},"2":{loc:{start:{line:46,column:4},end:{line:48,column:5}},type:"if",locations:[{start:{line:46,column:4},end:{line:48,column:5}},{start:{line:46,column:4},end:{line:48,column:5}}],line:46}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},inputSourceMap:{version:3,names:["OAuth2Client","require","User","jwt","client","process","env","GOOGLE_CLIENT_ID","googleLogin","token","ticket","verifyIdToken","idToken","audience","payload","getPayload","email","user","findOne","where","error","Error","statusCode","authToken","sign","userId","id","role","JWT_SECRET","expiresIn","firstName","lastName","profilePicture","NODE_ENV","console","module","exports"],sourceRoot:"D:\\rippers\\rippers-bn-be\\src\\Services\\",sources:["authService.js"],sourcesContent:["const { OAuth2Client } = require('google-auth-library');\r\nconst { User } = require('../../models');\r\nconst jwt = require('jsonwebtoken');\r\n\r\nconst client = new OAuth2Client(process.env.GOOGLE_CLIENT_ID);\r\n\r\nconst googleLogin = async (token) => {\r\n  try {\r\n    const ticket = await client.verifyIdToken({\r\n      idToken: token,\r\n      audience: process.env.GOOGLE_CLIENT_ID,\r\n    });\r\n\r\n    const payload = ticket.getPayload();\r\n    const email = payload.email;\r\n\r\n    const user = await User.findOne({ where: { email } });\r\n\r\n    if (!user) {\r\n      const error = new Error('Account does not exist. Please create an account first.');\r\n      error.statusCode = 404;\r\n      throw error;\r\n    }\r\n\r\n    const authToken = jwt.sign(\r\n      { userId: user.id, role: user.role },\r\n      process.env.JWT_SECRET,\r\n      { expiresIn: '1h' }\r\n    );\r\n\r\n    return {\r\n      userId: user.id,\r\n      firstName: user.firstName,\r\n      lastName: user.lastName,\r\n      email: user.email,\r\n      profilePicture: user.profilePicture,\r\n      token: authToken,\r\n    };\r\n  } catch (error) {\r\n    if (!error.statusCode) {\r\n      error.statusCode = 400;\r\n    }\r\n    // Only log in non-test environment\r\n    if (process.env.NODE_ENV !== 'test') {\r\n      console.error('Error in googleLogin:', error);\r\n    }\r\n    throw error;\r\n  }\r\n};\r\n\r\nmodule.exports = { googleLogin };"],mappings:"AAAA,MAAM;EAAEA;AAAa,CAAC,GAAGC,OAAO,CAAC,qBAAqB,CAAC;AACvD,MAAM;EAAEC;AAAK,CAAC,GAAGD,OAAO,CAAC,cAAc,CAAC;AACxC,MAAME,GAAG,GAAGF,OAAO,CAAC,cAAc,CAAC;AAEnC,MAAMG,MAAM,GAAG,IAAIJ,YAAY,CAACK,OAAO,CAACC,GAAG,CAACC,gBAAgB,CAAC;AAE7D,MAAMC,WAAW,GAAG,MAAOC,KAAK,IAAK;EACnC,IAAI;IACF,MAAMC,MAAM,GAAG,MAAMN,MAAM,CAACO,aAAa,CAAC;MACxCC,OAAO,EAAEH,KAAK;MACdI,QAAQ,EAAER,OAAO,CAACC,GAAG,CAACC;IACxB,CAAC,CAAC;IAEF,MAAMO,OAAO,GAAGJ,MAAM,CAACK,UAAU,CAAC,CAAC;IACnC,MAAMC,KAAK,GAAGF,OAAO,CAACE,KAAK;IAE3B,MAAMC,IAAI,GAAG,MAAMf,IAAI,CAACgB,OAAO,CAAC;MAAEC,KAAK,EAAE;QAAEH;MAAM;IAAE,CAAC,CAAC;IAErD,IAAI,CAACC,IAAI,EAAE;MACT,MAAMG,KAAK,GAAG,IAAIC,KAAK,CAAC,yDAAyD,CAAC;MAClFD,KAAK,CAACE,UAAU,GAAG,GAAG;MACtB,MAAMF,KAAK;IACb;IAEA,MAAMG,SAAS,GAAGpB,GAAG,CAACqB,IAAI,CACxB;MAAEC,MAAM,EAAER,IAAI,CAACS,EAAE;MAAEC,IAAI,EAAEV,IAAI,CAACU;IAAK,CAAC,EACpCtB,OAAO,CAACC,GAAG,CAACsB,UAAU,EACtB;MAAEC,SAAS,EAAE;IAAK,CACpB,CAAC;IAED,OAAO;MACLJ,MAAM,EAAER,IAAI,CAACS,EAAE;MACfI,SAAS,EAAEb,IAAI,CAACa,SAAS;MACzBC,QAAQ,EAAEd,IAAI,CAACc,QAAQ;MACvBf,KAAK,EAAEC,IAAI,CAACD,KAAK;MACjBgB,cAAc,EAAEf,IAAI,CAACe,cAAc;MACnCvB,KAAK,EAAEc;IACT,CAAC;EACH,CAAC,CAAC,OAAOH,KAAK,EAAE;IACd,IAAI,CAACA,KAAK,CAACE,UAAU,EAAE;MACrBF,KAAK,CAACE,UAAU,GAAG,GAAG;IACxB;IACA;IACA,IAAIjB,OAAO,CAACC,GAAG,CAAC2B,QAAQ,KAAK,MAAM,EAAE;MACnCC,OAAO,CAACd,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;IAC/C;IACA,MAAMA,KAAK;EACb;AACF,CAAC;AAEDe,MAAM,CAACC,OAAO,GAAG;EAAE5B;AAAY,CAAC",ignoreList:[]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"25acb9f92b55eba742f56a9f40706d8493f2935d"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_8xupy7a1z=function(){return actualCoverage;};}return actualCoverage;}cov_8xupy7a1z();const{OAuth2Client}=(cov_8xupy7a1z().s[0]++,require('google-auth-library'));const{User}=(cov_8xupy7a1z().s[1]++,require('../../models'));const jwt=(cov_8xupy7a1z().s[2]++,require('jsonwebtoken'));const client=(cov_8xupy7a1z().s[3]++,new OAuth2Client(process.env.GOOGLE_CLIENT_ID));cov_8xupy7a1z().s[4]++;const googleLogin=async token=>{cov_8xupy7a1z().f[0]++;cov_8xupy7a1z().s[5]++;try{const ticket=(cov_8xupy7a1z().s[6]++,await client.verifyIdToken({idToken:token,audience:process.env.GOOGLE_CLIENT_ID}));const payload=(cov_8xupy7a1z().s[7]++,ticket.getPayload());const email=(cov_8xupy7a1z().s[8]++,payload.email);const user=(cov_8xupy7a1z().s[9]++,await User.findOne({where:{email}}));cov_8xupy7a1z().s[10]++;if(!user){cov_8xupy7a1z().b[0][0]++;const error=(cov_8xupy7a1z().s[11]++,new Error('Account does not exist. Please create an account first.'));cov_8xupy7a1z().s[12]++;error.statusCode=404;cov_8xupy7a1z().s[13]++;throw error;}else{cov_8xupy7a1z().b[0][1]++;}const authToken=(cov_8xupy7a1z().s[14]++,jwt.sign({userId:user.id,role:user.role},process.env.JWT_SECRET,{expiresIn:'1h'}));cov_8xupy7a1z().s[15]++;return{userId:user.id,firstName:user.firstName,lastName:user.lastName,email:user.email,profilePicture:user.profilePicture,token:authToken};}catch(error){cov_8xupy7a1z().s[16]++;if(!error.statusCode){cov_8xupy7a1z().b[1][0]++;cov_8xupy7a1z().s[17]++;error.statusCode=400;}else{cov_8xupy7a1z().b[1][1]++;}// Only log in non-test environment
cov_8xupy7a1z().s[18]++;if(process.env.NODE_ENV!=='test'){cov_8xupy7a1z().b[2][0]++;cov_8xupy7a1z().s[19]++;console.error('Error in googleLogin:',error);}else{cov_8xupy7a1z().b[2][1]++;}cov_8xupy7a1z().s[20]++;throw error;}};cov_8xupy7a1z().s[21]++;module.exports={googleLogin};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPQXV0aDJDbGllbnQiLCJyZXF1aXJlIiwiVXNlciIsImp3dCIsImNsaWVudCIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQ0xJRU5UX0lEIiwiZ29vZ2xlTG9naW4iLCJ0b2tlbiIsInRpY2tldCIsInZlcmlmeUlkVG9rZW4iLCJpZFRva2VuIiwiYXVkaWVuY2UiLCJwYXlsb2FkIiwiZ2V0UGF5bG9hZCIsImVtYWlsIiwidXNlciIsImZpbmRPbmUiLCJ3aGVyZSIsImVycm9yIiwiRXJyb3IiLCJzdGF0dXNDb2RlIiwiYXV0aFRva2VuIiwic2lnbiIsInVzZXJJZCIsImlkIiwicm9sZSIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInByb2ZpbGVQaWN0dXJlIiwiTk9ERV9FTlYiLCJjb25zb2xlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXHJpcHBlcnNcXHJpcHBlcnMtYm4tYmVcXHNyY1xcU2VydmljZXNcXCIsInNvdXJjZXMiOlsiYXV0aFNlcnZpY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBPQXV0aDJDbGllbnQgfSA9IHJlcXVpcmUoJ2dvb2dsZS1hdXRoLWxpYnJhcnknKTtcclxuY29uc3QgeyBVc2VyIH0gPSByZXF1aXJlKCcuLi8uLi9tb2RlbHMnKTtcclxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcblxyXG5jb25zdCBjbGllbnQgPSBuZXcgT0F1dGgyQ2xpZW50KHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfSUQpO1xyXG5cclxuY29uc3QgZ29vZ2xlTG9naW4gPSBhc3luYyAodG9rZW4pID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdGlja2V0ID0gYXdhaXQgY2xpZW50LnZlcmlmeUlkVG9rZW4oe1xyXG4gICAgICBpZFRva2VuOiB0b2tlbixcclxuICAgICAgYXVkaWVuY2U6IHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfSUQsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBwYXlsb2FkID0gdGlja2V0LmdldFBheWxvYWQoKTtcclxuICAgIGNvbnN0IGVtYWlsID0gcGF5bG9hZC5lbWFpbDtcclxuXHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgd2hlcmU6IHsgZW1haWwgfSB9KTtcclxuXHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0FjY291bnQgZG9lcyBub3QgZXhpc3QuIFBsZWFzZSBjcmVhdGUgYW4gYWNjb3VudCBmaXJzdC4nKTtcclxuICAgICAgZXJyb3Iuc3RhdHVzQ29kZSA9IDQwNDtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXV0aFRva2VuID0gand0LnNpZ24oXHJcbiAgICAgIHsgdXNlcklkOiB1c2VyLmlkLCByb2xlOiB1c2VyLnJvbGUgfSxcclxuICAgICAgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCxcclxuICAgICAgeyBleHBpcmVzSW46ICcxaCcgfVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXHJcbiAgICAgIGZpcnN0TmFtZTogdXNlci5maXJzdE5hbWUsXHJcbiAgICAgIGxhc3ROYW1lOiB1c2VyLmxhc3ROYW1lLFxyXG4gICAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgICAgcHJvZmlsZVBpY3R1cmU6IHVzZXIucHJvZmlsZVBpY3R1cmUsXHJcbiAgICAgIHRva2VuOiBhdXRoVG9rZW4sXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBpZiAoIWVycm9yLnN0YXR1c0NvZGUpIHtcclxuICAgICAgZXJyb3Iuc3RhdHVzQ29kZSA9IDQwMDtcclxuICAgIH1cclxuICAgIC8vIE9ubHkgbG9nIGluIG5vbi10ZXN0IGVudmlyb25tZW50XHJcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICd0ZXN0Jykge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBnb29nbGVMb2dpbjonLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHsgZ29vZ2xlTG9naW4gfTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFBRUE7QUFBYSxDQUFDLEdBQUdDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQztBQUN2RCxNQUFNO0VBQUVDO0FBQUssQ0FBQyxHQUFHRCxPQUFPLENBQUMsY0FBYyxDQUFDO0FBQ3hDLE1BQU1FLEdBQUcsR0FBR0YsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUVuQyxNQUFNRyxNQUFNLEdBQUcsSUFBSUosWUFBWSxDQUFDSyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsZ0JBQWdCLENBQUM7QUFFN0QsTUFBTUMsV0FBVyxHQUFHLE1BQU9DLEtBQUssSUFBSztFQUNuQyxJQUFJO0lBQ0YsTUFBTUMsTUFBTSxHQUFHLE1BQU1OLE1BQU0sQ0FBQ08sYUFBYSxDQUFDO01BQ3hDQyxPQUFPLEVBQUVILEtBQUs7TUFDZEksUUFBUSxFQUFFUixPQUFPLENBQUNDLEdBQUcsQ0FBQ0M7SUFDeEIsQ0FBQyxDQUFDO0lBRUYsTUFBTU8sT0FBTyxHQUFHSixNQUFNLENBQUNLLFVBQVUsQ0FBQyxDQUFDO0lBQ25DLE1BQU1DLEtBQUssR0FBR0YsT0FBTyxDQUFDRSxLQUFLO0lBRTNCLE1BQU1DLElBQUksR0FBRyxNQUFNZixJQUFJLENBQUNnQixPQUFPLENBQUM7TUFBRUMsS0FBSyxFQUFFO1FBQUVIO01BQU07SUFBRSxDQUFDLENBQUM7SUFFckQsSUFBSSxDQUFDQyxJQUFJLEVBQUU7TUFDVCxNQUFNRyxLQUFLLEdBQUcsSUFBSUMsS0FBSyxDQUFDLHlEQUF5RCxDQUFDO01BQ2xGRCxLQUFLLENBQUNFLFVBQVUsR0FBRyxHQUFHO01BQ3RCLE1BQU1GLEtBQUs7SUFDYjtJQUVBLE1BQU1HLFNBQVMsR0FBR3BCLEdBQUcsQ0FBQ3FCLElBQUksQ0FDeEI7TUFBRUMsTUFBTSxFQUFFUixJQUFJLENBQUNTLEVBQUU7TUFBRUMsSUFBSSxFQUFFVixJQUFJLENBQUNVO0lBQUssQ0FBQyxFQUNwQ3RCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDc0IsVUFBVSxFQUN0QjtNQUFFQyxTQUFTLEVBQUU7SUFBSyxDQUNwQixDQUFDO0lBRUQsT0FBTztNQUNMSixNQUFNLEVBQUVSLElBQUksQ0FBQ1MsRUFBRTtNQUNmSSxTQUFTLEVBQUViLElBQUksQ0FBQ2EsU0FBUztNQUN6QkMsUUFBUSxFQUFFZCxJQUFJLENBQUNjLFFBQVE7TUFDdkJmLEtBQUssRUFBRUMsSUFBSSxDQUFDRCxLQUFLO01BQ2pCZ0IsY0FBYyxFQUFFZixJQUFJLENBQUNlLGNBQWM7TUFDbkN2QixLQUFLLEVBQUVjO0lBQ1QsQ0FBQztFQUNILENBQUMsQ0FBQyxPQUFPSCxLQUFLLEVBQUU7SUFDZCxJQUFJLENBQUNBLEtBQUssQ0FBQ0UsVUFBVSxFQUFFO01BQ3JCRixLQUFLLENBQUNFLFVBQVUsR0FBRyxHQUFHO0lBQ3hCO0lBQ0E7SUFDQSxJQUFJakIsT0FBTyxDQUFDQyxHQUFHLENBQUMyQixRQUFRLEtBQUssTUFBTSxFQUFFO01BQ25DQyxPQUFPLENBQUNkLEtBQUssQ0FBQyx1QkFBdUIsRUFBRUEsS0FBSyxDQUFDO0lBQy9DO0lBQ0EsTUFBTUEsS0FBSztFQUNiO0FBQ0YsQ0FBQztBQUVEZSxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUFFNUI7QUFBWSxDQUFDIiwiaWdub3JlTGlzdCI6W119
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfOHh1cHk3YTF6IiwiYWN0dWFsQ292ZXJhZ2UiLCJPQXV0aDJDbGllbnQiLCJzIiwicmVxdWlyZSIsIlVzZXIiLCJqd3QiLCJjbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiR09PR0xFX0NMSUVOVF9JRCIsImdvb2dsZUxvZ2luIiwidG9rZW4iLCJmIiwidGlja2V0IiwidmVyaWZ5SWRUb2tlbiIsImlkVG9rZW4iLCJhdWRpZW5jZSIsInBheWxvYWQiLCJnZXRQYXlsb2FkIiwiZW1haWwiLCJ1c2VyIiwiZmluZE9uZSIsIndoZXJlIiwiYiIsImVycm9yIiwiRXJyb3IiLCJzdGF0dXNDb2RlIiwiYXV0aFRva2VuIiwic2lnbiIsInVzZXJJZCIsImlkIiwicm9sZSIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInByb2ZpbGVQaWN0dXJlIiwiTk9ERV9FTlYiLCJjb25zb2xlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkQ6XFxyaXBwZXJzXFxyaXBwZXJzLWJuLWJlXFxzcmNcXFNlcnZpY2VzXFwvYXV0aFNlcnZpY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBPQXV0aDJDbGllbnQgfSA9IHJlcXVpcmUoJ2dvb2dsZS1hdXRoLWxpYnJhcnknKTtcclxuY29uc3QgeyBVc2VyIH0gPSByZXF1aXJlKCcuLi8uLi9tb2RlbHMnKTtcclxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcblxyXG5jb25zdCBjbGllbnQgPSBuZXcgT0F1dGgyQ2xpZW50KHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfSUQpO1xyXG5cclxuY29uc3QgZ29vZ2xlTG9naW4gPSBhc3luYyAodG9rZW4pID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdGlja2V0ID0gYXdhaXQgY2xpZW50LnZlcmlmeUlkVG9rZW4oe1xyXG4gICAgICBpZFRva2VuOiB0b2tlbixcclxuICAgICAgYXVkaWVuY2U6IHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfSUQsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBwYXlsb2FkID0gdGlja2V0LmdldFBheWxvYWQoKTtcclxuICAgIGNvbnN0IGVtYWlsID0gcGF5bG9hZC5lbWFpbDtcclxuXHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgd2hlcmU6IHsgZW1haWwgfSB9KTtcclxuXHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0FjY291bnQgZG9lcyBub3QgZXhpc3QuIFBsZWFzZSBjcmVhdGUgYW4gYWNjb3VudCBmaXJzdC4nKTtcclxuICAgICAgZXJyb3Iuc3RhdHVzQ29kZSA9IDQwNDtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXV0aFRva2VuID0gand0LnNpZ24oXHJcbiAgICAgIHsgdXNlcklkOiB1c2VyLmlkLCByb2xlOiB1c2VyLnJvbGUgfSxcclxuICAgICAgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCxcclxuICAgICAgeyBleHBpcmVzSW46ICcxaCcgfVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXHJcbiAgICAgIGZpcnN0TmFtZTogdXNlci5maXJzdE5hbWUsXHJcbiAgICAgIGxhc3ROYW1lOiB1c2VyLmxhc3ROYW1lLFxyXG4gICAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgICAgcHJvZmlsZVBpY3R1cmU6IHVzZXIucHJvZmlsZVBpY3R1cmUsXHJcbiAgICAgIHRva2VuOiBhdXRoVG9rZW4sXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBpZiAoIWVycm9yLnN0YXR1c0NvZGUpIHtcclxuICAgICAgZXJyb3Iuc3RhdHVzQ29kZSA9IDQwMDtcclxuICAgIH1cclxuICAgIC8vIE9ubHkgbG9nIGluIG5vbi10ZXN0IGVudmlyb25tZW50XHJcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICd0ZXN0Jykge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBnb29nbGVMb2dpbjonLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHsgZ29vZ2xlTG9naW4gfTsiXSwibWFwcGluZ3MiOiJ1OUxBY1U7QUFBQUEsYUFBQSxTQUFBQSxDQUFBLFNBQUFDLGNBQUEsV0FBQUEsY0FBQSxFQUFBRCxhQUFBLEdBZFYsS0FBTSxDQUFFRSxZQUFhLENBQUMsRUFBQUYsYUFBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxFQUN2RCxLQUFNLENBQUVDLElBQUssQ0FBQyxFQUFBTCxhQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUN4QyxLQUFNLENBQUFFLEdBQUcsRUFBQU4sYUFBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxjQUFjLENBQUMsRUFFbkMsS0FBTSxDQUFBRyxNQUFNLEVBQUFQLGFBQUEsR0FBQUcsQ0FBQSxNQUFHLEdBQUksQ0FBQUQsWUFBWSxDQUFDTSxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsZ0JBQWdCLENBQUMsRUFBQVYsYUFBQSxHQUFBRyxDQUFBLE1BRTdELEtBQU0sQ0FBQVEsV0FBVyxDQUFHLEtBQU8sQ0FBQUMsS0FBSyxFQUFLLENBQUFaLGFBQUEsR0FBQWEsQ0FBQSxNQUFBYixhQUFBLEdBQUFHLENBQUEsTUFDbkMsR0FBSSxDQUNGLEtBQU0sQ0FBQVcsTUFBTSxFQUFBZCxhQUFBLEdBQUFHLENBQUEsTUFBRyxLQUFNLENBQUFJLE1BQU0sQ0FBQ1EsYUFBYSxDQUFDLENBQ3hDQyxPQUFPLENBQUVKLEtBQUssQ0FDZEssUUFBUSxDQUFFVCxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsZ0JBQ3hCLENBQUMsQ0FBQyxFQUVGLEtBQU0sQ0FBQVEsT0FBTyxFQUFBbEIs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